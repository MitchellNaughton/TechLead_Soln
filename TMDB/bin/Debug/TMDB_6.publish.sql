/*
Deployment script for TMDB

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "TMDB"
:setvar DefaultFilePrefix "TMDB"
:setvar DefaultDataPath "C:\Users\mitch\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\MSSQLLocalDB\"
:setvar DefaultLogPath "C:\Users\mitch\AppData\Local\Microsoft\Microsoft SQL Server Local DB\Instances\MSSQLLocalDB\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
/*
The type for column dcTaxInc1 in table [dbo].[tmTax] is currently  FLOAT (53) NULL but is being changed to  DECIMAL (18, 2) NULL. Data loss could occur.

The type for column dcTaxInc2 in table [dbo].[tmTax] is currently  FLOAT (53) NULL but is being changed to  DECIMAL (18, 2) NULL. Data loss could occur.

The type for column dcTaxInc3 in table [dbo].[tmTax] is currently  FLOAT (53) NULL but is being changed to  DECIMAL (18, 2) NULL. Data loss could occur.

The type for column dcTaxRate1 in table [dbo].[tmTax] is currently  FLOAT (53) NULL but is being changed to  DECIMAL (18, 2) NULL. Data loss could occur.

The type for column dcTaxRate2 in table [dbo].[tmTax] is currently  FLOAT (53) NULL but is being changed to  DECIMAL (18, 2) NULL. Data loss could occur.

The type for column dcTaxRate3 in table [dbo].[tmTax] is currently  FLOAT (53) NULL but is being changed to  DECIMAL (18, 2) NULL. Data loss could occur.
*/

IF EXISTS (select top 1 1 from [dbo].[tmTax])
    RAISERROR (N'Rows were detected. The schema update is terminating because data loss might occur.', 16, 127) WITH NOWAIT

GO
PRINT N'The following operation was generated from a refactoring log file 6cf8b6b0-0c13-4a3e-b52a-35496d11cb94';

PRINT N'Rename [dbo].[tmTax].[flTaxInc1] to dcTaxInc1';


GO
EXECUTE sp_rename @objname = N'[dbo].[tmTax].[flTaxInc1]', @newname = N'dcTaxInc1', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file 8628052d-758b-454d-b891-c238ced3c0ad';

PRINT N'Rename [dbo].[tmTax].[flTaxInc2] to dcTaxInc2';


GO
EXECUTE sp_rename @objname = N'[dbo].[tmTax].[flTaxInc2]', @newname = N'dcTaxInc2', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file 1535c9db-436b-4ed9-98db-c4bbb42b2406';

PRINT N'Rename [dbo].[tmTax].[flTaxInc3] to dcTaxInc3';


GO
EXECUTE sp_rename @objname = N'[dbo].[tmTax].[flTaxInc3]', @newname = N'dcTaxInc3', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file 524d3b06-7498-4ebe-81a2-8de5ee606494';

PRINT N'Rename [dbo].[tmTax].[flTaxRate1] to dcTaxRate1';


GO
EXECUTE sp_rename @objname = N'[dbo].[tmTax].[flTaxRate1]', @newname = N'dcTaxRate1', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file 99c1627d-f3cb-476b-ae0b-273fcc4cd9f2';

PRINT N'Rename [dbo].[tmTax].[flTaxRate2] to dcTaxRate2';


GO
EXECUTE sp_rename @objname = N'[dbo].[tmTax].[flTaxRate2]', @newname = N'dcTaxRate2', @objtype = N'COLUMN';


GO
PRINT N'The following operation was generated from a refactoring log file b834bef9-bbdf-4fd0-bf31-46e6e686ce26';

PRINT N'Rename [dbo].[tmTax].[flTaxRate3] to dcTaxRate3';


GO
EXECUTE sp_rename @objname = N'[dbo].[tmTax].[flTaxRate3]', @newname = N'dcTaxRate3', @objtype = N'COLUMN';


GO
PRINT N'Altering [dbo].[tmTax]...';


GO
ALTER TABLE [dbo].[tmTax] ALTER COLUMN [dcTaxInc1] DECIMAL (18, 2) NULL;

ALTER TABLE [dbo].[tmTax] ALTER COLUMN [dcTaxInc2] DECIMAL (18, 2) NULL;

ALTER TABLE [dbo].[tmTax] ALTER COLUMN [dcTaxInc3] DECIMAL (18, 2) NULL;

ALTER TABLE [dbo].[tmTax] ALTER COLUMN [dcTaxRate1] DECIMAL (18, 2) NULL;

ALTER TABLE [dbo].[tmTax] ALTER COLUMN [dcTaxRate2] DECIMAL (18, 2) NULL;

ALTER TABLE [dbo].[tmTax] ALTER COLUMN [dcTaxRate3] DECIMAL (18, 2) NULL;


GO
-- Refactoring step to update target server with deployed transaction logs
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '6cf8b6b0-0c13-4a3e-b52a-35496d11cb94')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('6cf8b6b0-0c13-4a3e-b52a-35496d11cb94')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '8628052d-758b-454d-b891-c238ced3c0ad')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('8628052d-758b-454d-b891-c238ced3c0ad')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '1535c9db-436b-4ed9-98db-c4bbb42b2406')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('1535c9db-436b-4ed9-98db-c4bbb42b2406')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '524d3b06-7498-4ebe-81a2-8de5ee606494')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('524d3b06-7498-4ebe-81a2-8de5ee606494')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = '99c1627d-f3cb-476b-ae0b-273fcc4cd9f2')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('99c1627d-f3cb-476b-ae0b-273fcc4cd9f2')
IF NOT EXISTS (SELECT OperationKey FROM [dbo].[__RefactorLog] WHERE OperationKey = 'b834bef9-bbdf-4fd0-bf31-46e6e686ce26')
INSERT INTO [dbo].[__RefactorLog] (OperationKey) values ('b834bef9-bbdf-4fd0-bf31-46e6e686ce26')

GO

GO
PRINT N'Update complete.';


GO
